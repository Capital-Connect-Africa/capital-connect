<ng-container *ngIf="revenueRecords$ | async"></ng-container>
<ng-container *ngIf="revenueRecord$ | async"></ng-container>
<ng-container *ngIf="createRevenueRecord$ | async"></ng-container>
<ng-container *ngIf="UpdateRevenueRecord$ | async"></ng-container>
<ng-container *ngIf="opexRecords$ | async"></ng-container>
<ng-container *ngIf="opexRecord$ | async"></ng-container>
<ng-container *ngIf="createOpexRecord$ | async"></ng-container>
<ng-container *ngIf="UpdateOpexRecord$ | async"></ng-container>
<ng-container *ngIf="financialInfoRecords$ | async"></ng-container>
<ng-container *ngIf="financialInfoRecord$ | async"></ng-container>
<ng-container *ngIf="CreateFinancialInfoRecord$ | async"></ng-container>
<ng-container *ngIf="UpdateFinancialInfoRecord$ | async"></ng-container>



<div class="main">
  <div class="navbar">
    <app-navbar onDashboard="true"></app-navbar>
  </div>
  <main>
    <div class="left__col"> 
      <h2>Financial Reports</h2>
        <div class="flex flex-col gap-4">
          
          <div class="p-6 bg-gray-50 rounded">
            <p-tabView class="mb-6">
              <!-- Revenue Records Tab -->
              <p-tabPanel header="REVENUE RECORDS">
                <div class="mb-4">
                  <p-table [value]="revenueRecords" class="p-datatable-gridlines">
                    <ng-template pTemplate="header">
                      <tr>
                        <th>#</th>
                        <th>Description</th>
                        <th>Value</th>
                        <th>Actions</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-revenue let-i="rowIndex">
                      <tr>
                        <td>{{i+1}}</td>
                        <td>{{ revenue.description }}</td>
                        <td>{{ revenue.value | currency }}</td>
               
                        <td>
                          <div class="flex space-x-4">
                            <button  class="btn btn-sm btn-tertiary-alt btn-success-alt" (click)="showModalFunc(revenue,'view_revenue_records')">View</button>
                            <button  class="btn btn-sm" (click)="showModalFunc(revenue,'update_revenue_records')">Edit</button>
                          </div>
                        </td>
                        

                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </p-tabPanel>
          
              <!-- Opex Records Tab -->
              <p-tabPanel header="OPEX RECORDS">
                <div class="mb-4">
                  <p-table [value]="opexRecords" class="p-datatable-gridlines">
                    <ng-template pTemplate="header">
                      <tr>
                        <th>#</th>
                        <th>Description</th>
                        <th>Value</th>
                        <th>Actions</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-opex let-i="rowIndex">
                      <tr>
                        <td>{{i+1}}</td>
                        <td>{{ opex.description }}</td>
                        <td>{{ opex.value | currency }}</td>
                        <td>
                          <div class="flex space-x-4">
                            <button  class="btn btn-sm btn-tertiary-alt btn-success-alt" (click)="showModalFunc(opex,'view_opex_records')">View</button>
                            <button  class="btn btn-sm" (click)="showModalFunc(opex,'update_opex_records')">Edit</button>
                          </div>
                        </td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </p-tabPanel>
          
              <p-tabPanel header="FINANCIAL INFORMATION">
                <p-table [value]="financialInfoRecords" class="p-datatable-gridlines">
                  <ng-template pTemplate="header">
                    <tr>
                      <th>Year</th>
                      <th>Status</th>
                      <!-- <th>Notes</th> -->
                      <th>Created At</th>
                      <th>Updated At</th>
                      <th>Actions</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-info>
                    <tr>
                      <td>{{ info.year }}</td>
                      <td>{{ info.status }}</td>
                      <!-- <td>{{ info.notes }}</td> -->
                      <td>{{ info.createdAt | date: 'short' }}</td>
                      <td>{{ info.updatedAt | date: 'short' }}</td>
                      <td>
                        <div class="flex space-x-4">
                          <button  class="btn btn-sm btn-tertiary-alt btn-success-alt" (click)="showModalFuncFinancial(info, 'view_financial_info')">View</button>
                          <button  class="btn btn-sm" (click)="showModalFuncFinancial(info, 'update_financial_info')">Edit</button>
                        </div>
                      </td>
                    </tr>
                  </ng-template>
                </p-table>
              </p-tabPanel>
              
            </p-tabView>
          </div>
        </div>
    </div>


    <div class="right__col">     
      <app-advertisement-space [title]="'Advertise Here'" [body]="'This space is available for your advertising needs to reach more businesses. Contact us to learn more!'" />
    </div>
  </main>
</div>



<app-modal [(visible)]="showModal" [title]="title" [helperText]="helperText">
  <!-- View Revenue Record -->
  <div *ngIf="view_revenue_records">
    <p><strong>Description:</strong> {{ currentRecord.description }}</p>
    <p><strong>Value:</strong> {{ currentRecord.value | currency }}</p>
  </div>

  <!-- Update Revenue Record -->
  <div *ngIf="update_revenue_records" class="form_content__container">
    <div class="input__wrapper">
      <label for="description" class="input__label">Description</label>
      <input id="description" type="text" class="input__field" [(ngModel)]="currentRecord.description" />
    </div>
    <div class="input__wrapper">
      <label for="value" class="input__label">Value</label>
      <input id="value" type="number" class="input__field" [(ngModel)]="currentRecord.value" />
    </div>
    <div class="cta__group">
      <button class="btn btn-primary mt-2 btn-sm" (click)="saveUpdates()">Save</button>
    </div>
  </div>

  <!-- View Opex Record -->
  <div *ngIf="view_opex_records">
    <p><strong>Description:</strong> {{ currentRecord.description }}</p>
    <p><strong>Value:</strong> {{ currentRecord.value | currency }}</p>
  </div>

  <!-- Update Opex Record -->
  <div *ngIf="update_opex_records" class="form_content__container">
    <div class="input__wrapper">
      <label for="description" class="input__label">Description</label>
      <input id="description" type="text" class="input__field" styleClass="w-full gap-4" [(ngModel)]="currentRecord.description" />
    </div>
    <div class="input__wrapper">
      <label for="value" class="input__label">Value</label>
      <input id="value" type="number" class="input__field" styleClass="w-full gap-4" [(ngModel)]="currentRecord.value" />
    </div>
    <div class="cta__group">
      <button class="btn btn-primary mt-2 btn-sm" (click)="saveUpdates()">Save</button>
    </div>
  </div>

</app-modal>




<!-- Existing modals above -->
<app-modal [(visible)]="showFinancialModal" [title]="title" [helperText]="helperText">
  <!-- Financial Information Modal -->
  <!-- View Financial Information Record -->
  <div *ngIf="view_financial_info">
    <p><strong>Year:</strong> {{ currentFinancialRecord.year }}</p>
    <p><strong>Status:</strong> {{ currentFinancialRecord.status }}</p>
    <p><strong>Notes:</strong> {{ currentFinancialRecord.notes }}</p>
    <p><strong>Created At:</strong> {{ currentFinancialRecord.createdAt | date: 'short' }}</p>
    <p><strong>Updated At:</strong> {{ currentFinancialRecord.updatedAt | date: 'short' }}</p>
  </div>

  <!-- Update Financial Information Record -->
  <div *ngIf="update_financial_info" class="form_content__container">
    <div class="input__wrapper">
      <label for="year" class="input__label">Year</label>
      <input id="year" type="number" class="input__field" [(ngModel)]="currentFinancialRecord.year" />
    </div>
    <div class="input__wrapper">
      <label for="status" class="input__label">Status</label>
      <input id="status" type="text" class="input__field" [(ngModel)]="currentFinancialRecord.status" />
    </div>
    <div class="input__wrapper">
      <label for="notes" class="input__label">Notes</label>
      <textarea id="notes" class="input__field" [(ngModel)]="currentFinancialRecord.notes"></textarea>
    </div>
    <div class="cta__group">
      <button class="btn btn-primary mt-2 btn-sm" (click)="saveUpdates()">Save</button>
    </div>
  </div>
</app-modal>



